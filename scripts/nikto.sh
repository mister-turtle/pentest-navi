#!/usr/bin/env bash

python_bin="python"

function _nikto_single
{
    target="${1}"
    dirs_output="${2:-./nikto/}"


    echo "DEBUG: using $python_bin"
    dns="$( echo "${target}" | $python_bin -c 'from urllib.parse import urlparse;import sys;print(urlparse(sys.stdin.read()).netloc)' )"
    [[ -z "${dns}" ]] && { _pnavi_output "couldnt parse host name from ${target}"; return 1; }

    ## python urlparse netloc can contain the port as well, replace : with - for file friendliness
    dns=${dns//:/-}
    
    dirs_output="${dirs_output}${dns}/"
    mkdir -p "${dirs_output}"

    _pnavi_banner "nikto"
    _pnavi_output "Ouptut directory: ${dirs_output}"

    nikto -C all -host "${target}" -Save "${dirs_output}responses" -o "${dirs_output}nikto-${dns}.txt" 
}
